<!DOCTYPE html>
<html>
    <head>
    <style type="text/css">
        @font-face {
                font-family: gotham;
                src: url(/gotham-book-regular.otf);
            }
            body {
                background-color: #f2f0eb;
            }
            * {
                font-family: Helvetica Neue;
            }
            a:link,a:visited {
                color: #5e3f99;
            }
            img {
                max-width: 30%;
                height: auto;
            }
            input[type=text]:focus {
                border-color:   #f68826;
                box-shadow: 0 0 5px #f68826 !important;
            }
            input[type=email]:focus {
                border-color:   #f68826;
                box-shadow: 0 0 5px #f68826 !important;
            }


    </style>
        <title>Completed</title>
        <script src="https://unpkg.com/jquery"></script>
        <script src="/bundles/prettydiff?v=E3KTA7j8SjgR8NaAhm1jADBJxbWj5Yx1GQ2EdHBzuxE1"></script>

        <script src="https://unpkg.com/survey-jquery@0.12.10/survey.jquery.min.js"></script>

        <link rel="stylesheet" href="https://unpkg.com/bootstrap@3.3.7/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="./index.css">

    </head>
    <style>
        #phq,#oasis,#panas {
            font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 30%;
        }

        #phq td, #phq th,#oasis th, #panas th {
            border: 1px solid #ddd;
            padding: 8px;
            font-size: 15px;
        }

        #phq tr:nth-child(even){background-color: #f2f2f2;}
        #oasis tr:nth-child(even){background-color: #f2f2f2;}
        #panas tr:nth-child(even){background-color: #f2f2f2;}

        #phq tr:hover {background-color: #ddd;}
        #oasis tr:hover {background-color: #ddd;}
        #panas tr:hover {background-color: #ddd;}

        #phq th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #f68826;
            color: white;
        }

        #oasis th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #ed2d87;
            color: white;
        }
        #panas th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #5e3f99;
            color: white;
        }
    </style>
    <body>
        <center><a href="http://www.laureateinstitute.org/"><img class="logo" src="/images/logo.png"></a></center>

        

        <!-- Showing Time Elapsed
        <div style="position: fixed; left : 50% ;  background-color: #ff9900;"><center><p id="mkId"></p></center><p id="timeOutput"></p></div>
         -->
        
        <center>
            <div class="container-fluid">
                <hr style="border-top:3px solid #b1b3b6" />
                <br>
                <h1 style="padding: 17px" >Thank You For Your Participation!!</h1>
                <h3>You have completed all tasks and surveys for this study</h4>
                <br>
                Hi,<p id='mkturk_id' style="font-size: 30px;"></p>
                <p>The code for this HIT is: </p>
                <p><strong style="font-size: 70px">11853</strong></p>

                

                <br>
                <hr>

                <h2>PHQ Score:</h2>
                <p style="width: 50%;">The Patient Health Questionnaire (PHQ) is a self-administered version of the PRIME-MD diagnostic instrument for common mental disorders. If you like to know more about PHQ, click <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1495268/">here</a></p>

                <div class="table-responsive">
                    <table id="phq" class="table table-condensed" style="width: 40%;">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Session 1</th>
                                <th>Session 2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Your PHQ Score</td>
                                <td><strong id='phqscore1'>null</strong></td>
                                <td><strong id='phqscore2'>null</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                

                <div style="width: 90%">
                  <h4>PHQ Interpretation Score</h4>    

                  <p></p>                                                                                 
                  <div class="table-responsive">          
                  <table id="phq" class="table table-condensed">
                    <thead>
                      <tr>
                        <th>Total Score</th>
                        <th>Depression Severity</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>1 - 4</td>
                        <td>Minimal Depression</td>
                      </tr>
                      <tr>
                          <td>5 - 9</td>
                          <td>Mild Depression</td>
                      </tr>
                        <tr>
                          <td>10 - 14</td>
                          <td>Moderate Depression</td>
                        </tr>
                        <tr>
                          <td>15 - 19</td>
                          <td>Moderate Severe Depression</td>
                        </tr>
                            <tr>
                          <td>20 - 27</td>
                          <td>Severe Depression</td>
                        </tr>
                    </tbody>
                  </table>
                  </div>
                </div>

                

                <hr>
                <h2>OASIS Score:</h2>
                <p style="width: 40%;">The Overall Anxiety Severity and Impairment Scale (OASIS) is a 5-item self-report measure that can be used to assess severity and impairment associated with any anxiety disorder or multiple anxiety disorders. To learn more about OASIS click <a href='https://www.sciencedirect.com/science/article/pii/S0165032715000452'>here</a></p>
                <div class="table-responsive">
                        <table id="oasis" class="table table-condensed" style="width: 40%;">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Session 1</th>
                                    <th>Session 2</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Your OASIS Score</td>
                                    <td>
                                        <strong id="oasisscore1">null</strong>
                                    </td>
                                    <td>
                                        <strong id="oasisscore2">null</strong>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                
                <div class="table-responsive"> 
                    <h4>OASIS Interpretation Score</h4>          
                        <table id="oasis" class="table table-condensed">
                          <thead>
                            <tr>
                              <th>OASIS Score</th>
                              <th>Severity</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td> 1 - 5 </td>
                              <td>Moderate</td>
                            </tr>
                            <tr>
                                <td> 6 - 9 </td>
                                <td>Marked</td>
                            </tr>
                            <tr>
                                <td> > 10 </td>
                                <td>Severe</td>
                            </tr>
                          </tbody>
                        </table>
                        </div>
                


                <hr>
                <h2>PANAS Score:</h2>
                <p><strong id="asiTotal" style="font-size: 50px;"></strong></p>
                <p style="width: 50%;"> The Positive and Negative Affect Schedule (PANAS) is a self-report questionnaire that consists of two 10-item scales to measure both positive and negative affect.
                        <br>Positive Affect Score: Scores can range from 10 - 50, with higher scores representing higher levels of positive affect.
                        <br>Negative Affect Score: Scores can range from 10 - 50, with lower scores representing lower levels of negative affect.
                    To learn more about PANAS click
                    <a href="https://en.wikipedia.org/wiki/Positive_and_Negative_Affect_Schedule">here. </a></p>
                <div class="table-responsive">
                    <table id="panas" class="table table-condensed" style="width: 60%;">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Session 1</th>
                                <th>Session 2</th>
                                <th>Average (original study, n=660)</th>
                            </tr>
                        </thead>
                        <tbody style="font-size: 17px;">
                            <tr>
                                <td>Positive Affect Score</td>
                                <td><strong id="panasPositive1">null</strong></td>
                                <td><strong id="panasPositive2">null</strong></td>
                                <td><strong >29.7</strong></td>
                            </tr>
                            <tr>
                                <td>Negative Affect Score</td>
                                <td><strong id="panasNegative1">null</strong></td>
                                <td><strong id="panasNegative2">null</strong></td>
                                <td><strong >14.8</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <hr>

                <br>
                <div class="row" style="width: 60%;">
                    <div id="surveyElement"></div>
                    <div id="surveyResult"></div>    
                </div>
                <hr>
                <br>
                <br>
                <p>If you have any questions please email us at <a href="mailto:jtouthang@libr.net">jtouthang@libr.net</a></p>

            </div>

        </center>

        <div class="container-fluid">
            <center><p class="text-p">&copy; 2018 <a href="http://www.laureateinstitute.org">laureateinstitute.org</a>. All rights reserved.</center>
        </div>


        <script type="text/javascript">

            Survey.Survey.cssType = "bootstrap";
            Survey.defaultBootstrapCss.navigationButton = "btn btn-green";

            var json = {completedHtml:"<h1><strong>Thank You for your Feedback!</strong></h1>",pages:[{name:"page1",elements:[{type:"dropdown",name:"question1",title:"How would you rate your general experience for this task. As a reminder, this is on a scale of 1-10, with 1 being the worst and 10 being the best experience.",isRequired:true,choices:["1","2","3","4","5","6","7","8","9","10"]}]},{name:"page2",elements:[{type:"radiogroup",name:"question2",title:"Would you be willing to do tasks similar to this?",isRequired:true,choices:[{value:"0",text:"No"},{value:"1",text:"Yes"}]}]},{name:"page3",elements:[{type:"comment",name:"question3",title:"What did you DISLIKE about this HIT?",isRequired:true}]},{name:"page4",elements:[{type:"comment",name:"question4",title:"What did you LIKE about this HIT?",isRequired:true}]},{name:"page5",elements:[{type:"comment",name:"question5",title:"What other ways can we improve on?",isRequired:true}]}]}



            window.survey = new Survey.Model(json);

            survey.onComplete.add(function (result) {
                postSurveyData(result.data, '2', mkturkid, 'dp-feedback');
                //window.location.replace("/?session="+session+"&mkturk_id="+mkturkid+"&survey=phq");
             });


            // Parse the URL 
            function postSurveyData(data, session, mkturkid, surveyname){
                $.ajax({
                    type: 'POST',
                    url: 'saveSurvey/?session=' + session + '&mkturk_id=' + mkturkid + '&survey=' + surveyname,
                    data: JSON.stringify(data), // or JSON.stringify ({name: 'jonas'}),
                    success: function(data) { console.log('Data saved!') },
                    contentType: "application/json",
                    dataType: 'json'
                });
            }

            $("#surveyElement").Survey({model: survey});

            function getQueryVariable(variable) {
                var query = window.location.search.substring(1);
                var vars = query.split('&');
                for (var i = 0; i < vars.length; i++) {
                    var pair = vars[i].split('=');
                    if (decodeURIComponent(pair[0]) == variable) {
                        return decodeURIComponent(pair[1]);
                    }
                }
                return 'NULL'
            }

            // Get Query Variables


            var mkturkid = getQueryVariable('mkturk_id');
            var timeleft = getQueryVariable('timeleft');


            document.getElementById("mkturk_id").innerHTML = mkturkid;


            // get the scores
            $.get('/getPHQ?session=1&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("phqscore1").innerHTML = data;
            });
            $.get('/getPHQ?session=2&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("phqscore2").innerHTML = data;
            });

            $.get('/getOASIS?session=1&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("oasisscore1").innerHTML = data;
            });
            $.get('/getOASIS?session=2&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("oasisscore2").innerHTML = data;
            });
            
            $.get('/getPANAS?type=positive&session=1&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("panasPositive1").innerHTML = data;
            });
            $.get('/getPANAS?type=positive&session=2&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("panasPositive2").innerHTML = data;
            });
            $.get('/getPANAS?type=negative&session=1&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("panasNegative1").innerHTML = data;
            });
            $.get('/getPANAS?type=negative&session=2&mkturk_id=' + mkturkid, function(data) {
                document.getElementById("panasNegative2").innerHTML = data;
            });          



            setTimeout(function () {
                // body...
                document.getElementById('plot').src = "/stats/" + mkturkid + "DP.html"
            },1500) // upate after 700 ms

            //$("#timeleft").text(timeleft);
        </script>
        <script>
            // Set the date we're counting down to

            // date format: "Sep 5, 2018 15:37:25"

            //timeleft
            var countDownDate = new Date(decodeURIComponent(timeleft)).getTime();

            // Update the count down every 1 second
            var x = setInterval(function() {


                // Get todays date and time
                var now = new Date().getTime();
                
                // Find the distance between now an the count down date
                var distance = countDownDate - now;
                
                // Time calculations for days, hours, minutes and seconds
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                // Output the result in an element with id="demo"
                document.getElementById("demo").innerHTML = hours + "h "
                + minutes + "m " + seconds + "s ";
                
                // If the count down is over, write some text
                // If the count down is over, redirect to session 2
                if (distance < 0) {
                    clearInterval(x);
                    window.location.href = "/?session=2"+"&mkturk_id="+mkturkid+"&survey=demo";
                    document.getElementById("demo").innerHTML = "EXPIRED";
                }
            }, 1000);
        </script>

    </body>
</html>