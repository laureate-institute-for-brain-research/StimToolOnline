<!DOCTYPE html>
<html>
    <head>
        <title>Demo Survey</title>
        <script src="https://unpkg.com/jquery"></script>
        <script src="/bundles/prettydiff?v=E3KTA7j8SjgR8NaAhm1jADBJxbWj5Yx1GQ2EdHBzuxE1"></script>

        <script src="https://unpkg.com/survey-jquery@0.12.10/survey.jquery.min.js"></script>

        <link rel="stylesheet" href="https://unpkg.com/bootstrap@3.3.7/dist/css/bootstrap.min.css">

    </head>
    <body>

        
        <center><a href="http://www.laureateinstitute.org/"><img class="logo" src="/images/logo.png"></a></center>
        

        <!-- Showing Time Elapsed
        <div style="position: fixed; left : 50% ;  background-color: #ff9900;"><center><p id="mkId"></p></center><p id="timeOutput"></p></div>
         -->
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-10">
                    <h1 style="padding: 17px" >Demographics Survey</h1>
                </div>
            </div>


            <div class="row">
                <p align="right" class="col-md-10" >Mechanical Turk ID:</p>
                <a align="right" id="mkid"></a> 
            </div>

            <div class="row">
                <p align="right" class="col-md-10">Session: </p>
                <a align="right" id="session"></a>   
            </div>

            <div class="row">
                <p align="right" class="col-md-10">Time Spent on Question: </p>
                <a align="right" id="timeEl"></a> 
                </p>
            </div>

            <div class="row" style="padding: 17px">
                <div id="surveyElement"></div>
                <div id="surveyResult"></div>    
            </div>


        </div>

        <div class="container-fluid">
            <center><p class="text-p">&copy; 2017 <a href="http://www.laureateinstitute.org">laureateinstitute.org</a>. All rights reserved.</center>
        </div>


        <script type="text/javascript">
            
            Survey.Survey.cssType = "bootstrap";
            Survey.defaultBootstrapCss.navigationButton = "btn btn-green";

            var json = {pages:[{elements:[{type:"radiogroup",choices:[{value:"1",text:"Male"},{value:"2",text:"Female"}],isRequired:true,name:"demps_gender",title:"Gender"}],name:"page1"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Hispanic or Latino"},{value:"2",text:"Not Hispanic or Latino"}],isRequired:true,name:"demps_ethnicity",title:"Ethnic Category"}],name:"page2"},{elements:[{type:"text",isRequired:true,name:"demps_ageimm",title:"If you were born and/or raised outside of the United States, how old were you when you came to the United States? (Enter 'NA, if not)"}],name:"page3"},{elements:[{type:"text",isRequired:true,name:"demps_fluentlangs",title:"What languages do you speak fluently?"}],name:"page4"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_engprimary",title:"Is English your primary language?"}],name:"page5"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_speaklanghomegu",title:"Did you speak a language other than English at home when you were growing up?"}],name:"page6"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_intactfamorigin",title:"Were you raised in an intact family of origin?"}],name:"page7"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Single"},{value:"2",text:"Married"},{value:"3",text:"Divorced"},{value:"4",text:"Separated"},{value:"5",text:"Widowed"},{value:"6",text:"Significant Other"}],hasOther:true,isRequired:true,name:"demps_maritalstatus",title:"Marital Status"}],name:"page8"},{elements:[{type:"text",inputType:"number",isRequired:true,name:"demps_nmarried",title:"If been Married, How many times have you been married? (Enter a number. otherwise, 0)"}],name:"page9"},{elements:[{type:"text",inputType:"number",isRequired:true,name:"demps_ndivorce",title:"If been married, How many of your marriages ended in divorce or annulment? (Enter a number. otherwise, 0)"}],name:"page10"},{elements:[{type:"text",inputType:"number",isRequired:true,name:"demps_agemarriage1",title:"If Married, How old were you when you got married for the first time? (Enter a number. otherwise, 0)"}],name:"page11"},{elements:[{type:"dropdown",name:"demps_nchild",title:"How many biological children do you have?",isRequired:true,choices:["0","1","2","3","4","5","6","7","8","9","10"]}],name:"page12"},{elements:[{type:"dropdown",name:"demps_nsachild",title:"How many step-children or adopted children do you have?",isRequired:true,choices:["0","1","2","3","4","5","6","7","8","9","10"]}],name:"page13"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Mobile home"},{value:"2",text:"One-family house detached from any other house"},{value:"3",text:"One-family house attached to one or more houses"},{value:"4",text:"Building with 2 or more apartments"},{value:"5",text:"Boat/RV/Van; etc;"}],hasOther:true,isRequired:true,name:"question1",title:"What best describes the building where you currently live?"}],name:"page14"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"No schooling completed"},{value:"2",text:"Nursery school"},{value:"3",text:"Kindergarten"},{value:"4",text:"Grade 1 through 11"},{value:"5",text:"12th grade (no diploma)"},{value:"6",text:"Regular high school diploma"},{value:"7",text:"GED or alternative credential"},{value:"8",text:"Some college credit, but less than 1 year of college credit"},{value:"9",text:"1 or more years of college credit, no degree"},{value:"10",text:"Associate's degree (for example: AA/AS)"},{value:"11",text:"Bachelor's degree (for example: BA/BS)"},{value:"12",text:"Master's degree (for example: MA/ MS/ MEng/MEd/ MSW/MBA)"},{value:"13",text:"Professional degree beyond a bachelor's degree (for example: MD/ DDS/ DVM/ LLB/JD)"},{value:"14",text:"Doctorate degree (for example: PhD/ EdD)"}],hasOther:true,isRequired:true,name:"demps_education",title:"What is the highest degree or level of school you have completed?"}],name:"page15"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Legislators and Senior Officials"},{value:"2",text:"Corporate Managers"},{value:"3",text:"General Managers"},{value:"4",text:"Physical, Mathematical and Engineering Science Professionals"},{value:"5",text:"Life Science and Health Professionals"},{value:"6",text:"Teaching Professionals"},{value:"7",text:"Other Professionals"},{value:"8",text:"Physical and Engineering Science Associate Professionals"},{value:"9",text:"Life Science and Health Associate Professionals"},{value:"10",text:"Teaching Associate Professionals"},{value:"11",text:"Other Associate Professionals"},{value:"12",text:"Office Clerks"},{value:"13",text:"Customer Service Clerks"},{value:"14",text:"Personal and Protective Services Workers"},{value:"15",text:"Models, Salespersons and Demonstrators"},{value:"16",text:"Market-oriented Skilled Agricultural and Fishery Workers"},{value:"17",text:"Subsistence Agricultural and Fishery Workers"},{value:"18",text:"Extraction and Building Trade Workers"},{value:"19",text:"Metal, Machinery and Related Trade Workers"},{value:"20",text:"Precision, Handicraft, Printing and Related Trade Workers"},{value:"21",text:"Other Craft and Related Trade Workers"},{value:"22",text:"Stationary Plant and Related Operators"},{value:"23",text:"Machine Operators and Assemblers"},{value:"24",text:"Drivers and Mobile Plant Operators"},{value:"25",text:"Sales and Services Elementary Occupations"},{value:"26",text:"Agricultural, Fishery and Related Laborers"},{value:"27",text:"Laborers in Mining, Construction, Manufacturing and Transport"},{value:"28",text:"Armed Forces"},{value:"29",text:"Unemployed"},{value:"30",text:"Disabled"}],hasOther:true,isRequired:true,name:"demps_education",title:"What kind of work do you normally do?"}],name:"page16"},{elements:[{type:"text",inputType:"number",isRequired:true,name:"demps_sincelastjob",title:"If you are not currently working, how long has it been (in days) since the last time you had a paid job?"}],name:"page17"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Fired"},{value:"2",text:"Laid off"},{value:"3",text:"Plant/company closed"},{value:"4",text:"Quit"},{value:"5",text:"Retired"},{value:"6",text:"Work force reduction"},{value:"7",text:"Return to school"}],hasOther:true,isRequired:true,name:"demps_leftjobreason",title:"Why did you leave your last job?"}],name:"page18"},{elements:[{type:"html",name:"sectionHeader",html:"Are you currently covered by any of the following types of health insurance or health coverage plans?"},{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insemployer",title:"Insurance through current or former employer"}],name:"page19"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insdirect",title:"Insurance purchased directly from an insurance company"}],name:"page20"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insmedicare",title:"Medicare, for people 65 and older, or people with certain disabilities"}],name:"page21"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insmedicaid",title:"Medicaid, Medical Assistance, or any kind of government-assistance plan for those with low incomes or a disability"}],name:"page22"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insmilitary",title:"TRICARE or other military health care"}],name:"page23"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insva",title:"Veteran's Administration health care"}],name:"page24"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_insihs",title:"Indian Health Service"}],name:"page25"},{elements:[{type:"text",isRequired:true,name:"demps_insotherdesc",title:"Any other type of health insurance or health coverage plan. Please describe:"}],name:"page26"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Never served in the military"},{value:"2",text:"Only on active duty for training in the Reserves or National Guard"},{value:"3",text:"Now on active duty"},{value:"4",text:"On active duty in the past, but not now"}],isRequired:true,name:"demps_service",title:"Have you ever served on active duty in the U.S. Armed Forces, Reserves or National Guard?"}],name:"page27"},{elements:[{type:"text",isRequired:true,name:"demps_servicebranch",title:"Branch"}],name:"page28"},{elements:[{type:"text",inputType:"number",isRequired:true,name:"demps_serviceyears",title:"Years of Service"}],name:"page29"},{elements:[{type:"text",isRequired:true,name:"demps_servicehighestrank",title:"\tHighest Rank Achieved"}],name:"page30"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"A. Less than $0 (loss)"},{value:"2",text:"B. $0 (None)"},{value:"3",text:"C. $1 - $999"},{value:"4",text:"D. $1,000 - $1,999"},{value:"5",text:"E. $2,000 - $2,999"},{value:"6",text:"F. $3,000 - $3,999"},{value:"7",text:"G. $4,000 - $4,999"},{value:"8",text:"H. $5,000 - $5,999"},{value:"9",text:"I. $6,000 - $6,999"},{value:"10",text:"J. $7,000 - $7,999"},{value:"11",text:"K. $8,000 - $8,999"},{value:"12",text:"L. $9,000 - $9,999"},{value:"13",text:"M. $10,000 - $10,999"},{value:"14",text:"N. $11,000 - $11,999"},{value:"15",text:"O. $12,000 - $12,999"},{value:"16",text:"P. $13,000 - $13,999"},{value:"17",text:"Q. $14,000 - $14,999"},{value:"18",text:"R. $15,000 - $15,999"},{value:"19",text:"S. $16,000 - $16,999"},{value:"20",text:"T. $17,000 - $17,999"},{value:"21",text:"U. $18,000 - $18,999"},{value:"22",text:"V. $19,000 - $19,999"},{value:"23",text:"W. $20,000 - $24,999"},{value:"24",text:"X. $25,000 - $29,999"},{value:"25",text:"Y. $30,000 - $34,999"},{value:"26",text:"Z. $35,000 - $39,999"},{value:"27",text:"AA. $40,000 - $44,999"},{value:"28",text:"BB. $45,000 - $49,999"},{value:"29",text:"CC. $50,000 - $74,999"},{value:"30",text:"DD. $75,000 - $99,999"},{value:"31",text:"EE. $100,000 - $149,999"},{value:"32",text:"FF. $150,000 - $199,999"},{value:"33",text:"GG. $200,000 - $299,999"},{value:"34",text:"HH. $300,000 - $499,999"},{value:"35",text:"II. $500,000 - $999,999"},{value:"36",text:"JJ. $1,000,000 or more"}],isRequired:true,name:"demps_householdincome",title:"Which best represents your household income in the past 12 months, before taxes?"}],name:"page31"},{elements:[{type:"radiogroup",choices:[{value:"1",text:"Yes"},{value:"0",text:"No"}],isRequired:true,name:"demps_welfare",title:"Have you ever received public assistance or welfare since turning 18, such as id to Families with Dependent Children, General Assistance, or Temporary Assistance for Needy Families?"}],name:"page32"},{elements:[{type:"text",isRequired:true,name:"demps_welfareage",title:"If yes, how old were you the last time you received public assistance?"}],name:"page33"}]}



            window.survey = new Survey.Model(json);


            
            var timerID = null;

            lastpage = survey.currentPage;

            function timerLoop(elapsed){
                var page = survey.currentPage; // page variable is the currentPage on the survey
                if (!page) return;
                if (lastpage != page) {
                    // set new start date
                    start = new Date().getTime(); // sets new start Date object when page has changed.
                    lastpage = page // sets the last page to currente page 

                }
                var valueName = "TRQ" + survey.pages.indexOf(page);

                var ms = survey.getValue(valueName);  // gets the value of the valuename. e.g: TRQ1

                if( ms == null) ms = 0;
                else ms = elapsed;
                survey.setValue(valueName, ms);
                $('#timeEl').text(elapsed + ' ms');
            }

            function getQueryVariable(variable) {
                var query = window.location.search.substring(1);
                var vars = query.split('&');
                for (var i = 0; i < vars.length; i++) {
                    var pair = vars[i].split('=');
                    if (decodeURIComponent(pair[0]) == variable) {
                        return decodeURIComponent(pair[1]);
                    }
                }
                return 'NULL'
            }



            survey.showProgressBar = "bottom";

            survey.goNextPageAutomatic = true
            survey.showNavigationButtons = true;
            survey.showCompletedPage = false;

            // Get Query Variables

            var session = getQueryVariable('session');
            var mkturkid = getQueryVariable('mkturk_id');
            var surveyname = getQueryVariable('survey');

            survey.onComplete.add(function (result) {
                postSurveyData(result.data, session, mkturkid, surveyname);
                window.location.replace("/?session="+session+"&mkturk_id="+mkturkid+"&survey=phq");
             });


            // Parse the URL 
            function postSurveyData(data, session, mkturkid, surveyname){
                $.ajax({
                    type: 'POST',
                    url: 'saveSurvey/?session=' + session + '&mkturk_id=' + mkturkid + '&survey=' + surveyname,
                    data: JSON.stringify(data), // or JSON.stringify ({name: 'jonas'}),
                    success: function(data) { console.log('Data saved!') },
                    contentType: "application/json",
                    dataType: 'json'
                });
            }

            $("#surveyElement").Survey({model: survey});
            $("#mkid").text(mkturkid);
            $("#session").text(session);


            //timerLoop(0);

            var start = new Date().getTime(),
                elapsed = '0.0';
            // executes timerLoop every 5 ms
            timerID = window.setInterval(function(){
                
                var time = new Date().getTime() - start;
                elapsed = Math.floor(time);

                //alert(elapsed);
                //$('#timeEl').text(elapsed + ' ms');

                //displayTime(1);
                timerLoop(elapsed);

            }, 5);

        </script>

    </body>
</html>